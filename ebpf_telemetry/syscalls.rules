# syscalls.rules
# each line starts with the syscall number to log
# followed by space-separated clauses
# each clause can be an argument (a0 .. a5), an operator (=, <, >, &, |)
# and a value (leading 0 for octal, 0x for hex)
# OR can be the global P or V. P indicates all events generated for this
# syscall number must correctly parse standard fields, and V indicates that
# all events for this syscall number must correctly parse any syscall-specific
# fields.
# Operator & ANDs the argument and the value and checks the result equals
# the value (&= in auditctl); and operator | ANDs the argument with the value
# and checks the result is not 0 (& in auditctl).

# open
2
# mmap - prot has write and exec bits
9 a2 & 0x6
# mprotect - prot has exec bit
10 a2 | 0x4
# connect
42
# accept
43
# execve
59
# kill - signal is 9 (KILL) or 19 (STOP)
62 a1 = 9 a1 = 19
# truncate
76
# ftruncate
77
# rename
82
# rmdir
84
# creat
85
# link
86
# unlink
87
# symlink
88
# chmod
90
# fchmod
91
# chown
92
# fchown
93
# lchown
94
# ptrace
101
# mknod
133
# adjtimex
159
# settimeofday
164
# init_module
175
# delete_module
176
# tkill - signal is 9 (KILL) or 19 (STOP)
200 a1 = 9 a1 = 19
# remap_file_pages - prot has write and exec bits
216 a2 & 0x6
# clock_settime
227
# tgkill - signal is 9 (KILL) or 19 (STOP)
234 a2 = 9 a2 = 19
# kexec_load
246
# openat - mode includes O_WRONLY (1) or O_RDWR (2)
257 a2 | 0x3
# mknodat
259
# fchownat
260
# unlinkat
263
# renameat
264
# linkat
265
# symlinkat
266
# fchmodat
268
# accept4
288
# clock_adjtime
305
# finit_module
313
# renameat2
316
# kexec_file_load
320
# execveat
322
